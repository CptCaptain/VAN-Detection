data = {'val': {'type': 'CocoDataset', 'ann_file': '/home/nils/VAN-Detection/datasets/coco/annotations/instances_val2017.json', 'pipeline': [{'type': 'LoadImageFromFile'}, {'flip': False, 'type': 'MultiScaleFlipAug', 'img_scale': [(1333, 800)], 'transforms': [{'type': 'Resize', 'img_scale': [(1333, 800)], 'keep_ratio': True}, {'type': 'RandomFlip'}, {'std': [58.395, 57.12, 57.375], 'mean': [123.675, 116.28, 103.53], 'type': 'Normalize', 'to_rgb': True}, {'type': 'Pad', 'size_divisor': 32}, {'keys': ['img'], 'type': 'ImageToTensor'}, {'keys': ['img'], 'type': 'Collect'}]}], 'img_prefix': '/home/nils/VAN-Detection/datasets/coco/val2017/'}, 'test': {'type': 'CocoDataset', 'ann_file': '/home/nils/VAN-Detection/datasets/coco/annotations/instances_val2017.json', 'pipeline': [{'type': 'LoadImageFromFile'}, {'flip': False, 'type': 'MultiScaleFlipAug', 'img_scale': [(1333, 800)], 'transforms': [{'type': 'Resize', 'img_scale': [(1333, 800)], 'keep_ratio': True}, {'type': 'RandomFlip'}, {'std': [58.395, 57.12, 57.375], 'mean': [123.675, 116.28, 103.53], 'type': 'Normalize', 'to_rgb': True}, {'type': 'Pad', 'size_divisor': 32}, {'keys': ['img'], 'type': 'ImageToTensor'}, {'keys': ['img'], 'type': 'Collect'}]}], 'img_prefix': '/home/nils/VAN-Detection/datasets/coco/val2017/'}, 'train': {'type': 'CocoDataset', 'ann_file': '/home/nils/VAN-Detection/datasets/coco/annotations/instances_train2017.json', 'pipeline': [{'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'Resize', 'img_scale': [(1333, 800)], 'keep_ratio': True}, {'type': 'RandomFlip', 'flip_ratio': 0.5}, {'std': [58.395, 57.12, 57.375], 'mean': [123.675, 116.28, 103.53], 'type': 'Normalize', 'to_rgb': True}, {'type': 'Pad', 'size_divisor': 32}, {'type': 'DefaultFormatBundle'}, {'keys': ['img', 'gt_bboxes', 'gt_labels'], 'type': 'Collect'}], 'img_prefix': '/home/nils/VAN-Detection/datasets/coco/train2017/'}, 'samples_per_gpu': 2, 'workers_per_gpu': 0}
dims = [64, 128, 320, 512]
model = {'neck': [{'type': 'FPN', 'num_outs': 5, 'in_channels': [64, 128, 320, 512], 'start_level': 1, 'out_channels': 256, 'add_extra_convs': 'on_output'}, {'type': 'DyHead', 'num_blocks': 6, 'in_channels': 256, 'out_channels': 256}], 'type': 'ATSS', 'backbone': {'type': 'VAN_Official', 'depths': [3, 3, 12, 3], 'init_cfg': {'type': 'Pretrained', 'checkpoint': '/home/nils/VAN-Detection/models/van_base_828.pth.tar'}, 'norm_cfg': {'type': 'SyncBN', 'requires_grad': True}, 'embed_dims': [64, 128, 320, 512], 'drop_path_rate': 0.2}, 'test_cfg': {'nms': {'type': 'nms', 'iou_threshold': 0.6}, 'nms_pre': 1000, 'score_thr': 0.05, 'max_per_img': 100, 'min_bbox_size': 0}, 'bbox_head': {'type': 'ATSSHead', 'loss_cls': {'type': 'FocalLoss', 'alpha': 0.25, 'gamma': 2, 'loss_weight': 1, 'use_sigmoid': True}, 'loss_bbox': {'type': 'GIoULoss', 'loss_weight': 2}, 'bbox_coder': {'type': 'DeltaXYWHBBoxCoder', 'target_stds': [0.1, 0.1, 0.2, 0.2], 'target_means': [0, 0, 0, 0]}, 'in_channels': 256, 'num_classes': 80, 'feat_channels': 256, 'stacked_convs': 0, 'loss_centerness': {'type': 'CrossEntropyLoss', 'loss_weight': 1, 'use_sigmoid': True}, 'anchor_generator': {'type': 'AnchorGenerator', 'ratios': [1], 'strides': [8, 16, 32, 64, 128], 'octave_base_scale': 8, 'scales_per_octave': 1}}, 'train_cfg': {'debug': False, 'assigner': {'topk': 9, 'type': 'ATSSAssigner'}, 'pos_weight': -1, 'allowed_border': -1}}
runner = {'type': 'EpochBasedRunner', 'max_epochs': 12}
gpu_ids = [0, 1, 2]
norm_cfg = {'type': 'SyncBN', 'requires_grad': True}
work_dir = './work_dirs/atss_van_b2_fpn_dyhead_coco'
workflow = [['train', 1], ['val', 1]]
data_root = '/home/nils/VAN-Detection/datasets/coco/'
load_from = None
log_level = 'INFO'
lr_config = {'step': [8, 11], 'policy': 'step', 'warmup': 'linear', 'warmup_iters': 500, 'warmup_ratio': 0.001}
optimizer = {'lr': 0.01, 'type': 'SGD', 'momentum': 0.9, 'weight_decay': 0.0001}
evaluation = {'metric': ['bbox'], 'interval': 1}
log_config = {'hooks': [{'type': 'TextLoggerHook', 'by_epoch': True, 'reset_flag': True}, {'type': 'MMDetWandbHook', 'by_epoch': True, 'interval': 10, 'init_kwargs': {'tags': ['backbone:VAN-B2', 'neck:FPN', 'neck:DyHeadhead:ATSS', 'pretrained'], 'entity': 'nkoch-aitastic', 'project': 'van-detection'}, 'log_checkpoint': True, 'num_eval_images': 100, 'log_checkpoint_metadata': True}], 'interval': 50}
auto_resume = False
dist_params = {'backend': 'nccl'}
resume_from = None
custom_hooks = [{'type': 'NumClassCheckHook'}]
dataset_type = 'CocoDataset'
img_norm_cfg = {'std': [58.395, 57.12, 57.375], 'mean': [123.675, 116.28, 103.53], 'to_rgb': True}
test_pipeline = [{'type': 'LoadImageFromFile'}, {'flip': False, 'type': 'MultiScaleFlipAug', 'img_scale': [(1333, 800)], 'transforms': [{'type': 'Resize', 'img_scale': [(1333, 800)], 'keep_ratio': True}, {'type': 'RandomFlip'}, {'std': [58.395, 57.12, 57.375], 'mean': [123.675, 116.28, 103.53], 'type': 'Normalize', 'to_rgb': True}, {'type': 'Pad', 'size_divisor': 32}, {'keys': ['img'], 'type': 'ImageToTensor'}, {'keys': ['img'], 'type': 'Collect'}]}]
train_pipeline = [{'type': 'LoadImageFromFile'}, {'type': 'LoadAnnotations', 'with_bbox': True}, {'type': 'Resize', 'img_scale': [(1333, 800)], 'keep_ratio': True}, {'type': 'RandomFlip', 'flip_ratio': 0.5}, {'std': [58.395, 57.12, 57.375], 'mean': [123.675, 116.28, 103.53], 'type': 'Normalize', 'to_rgb': True}, {'type': 'Pad', 'size_divisor': 32}, {'type': 'DefaultFormatBundle'}, {'keys': ['img', 'gt_bboxes', 'gt_labels'], 'type': 'Collect'}]
cudnn_benchmark = True
optimizer_config = {'grad_clip': None}
checkpoint_config = {'max_keep_ckpts': 3}
